<!-- <div class="modal on" >
    
</div> -->
<style>
    #module-pembayaran .progress-bar{
        display: flex;
        width: 100%;
    }
    #module-pembayaran .progress-bar .wrapper{
        display: block;
        width: 100%;
        height: 2rem;
        padding: 0.5rem;
        background-color: var(--background-color-button-light);
        border-radius: 1rem;
        overflow: hidden;
    }
    #module-pembayaran .progress-bar .wrapper .fill{
        background-color: var(--background-color-button);
        width: var(--progress-fill);
        border-radius: 1rem;
        min-width: 0%;
        max-width: 100%;
        height: 100%;
        animation: flashing 1s infinite;
    }
    @keyframes flashing {
        0%{
            filter: brightness(0.5);
        }
        100%{
            filter: brightness(1);
        }
    }
</style>
<div class="container" id="module-pembayaran"><br>
    <h2 class="wide"><i class="fas fa-badge-check"></i>&nbsp;Info Pembayaran</h2>
    <h1><span class="payment-progress-percent">.......</span></h1>
    <h4><span class="payment-current">.....</span></h4>
    <div class="progress-bar">
        <div class="wrapper">
            <div class="fill payment-progress" style="--progress-fill: 0%;"></div>
        </div>
    </div>
    <p class="payment-pesan">.......</p>
    <br>
</div>
<script>
    
    function modulePembayaranSingle() {
        // Load data pembayaran
        let procOncePembayaranSingle = setInterval(() => {
            let data = appData.pembayaran;

            // Format rupiah
            const rupiah = (number)=>{
                return new Intl.NumberFormat("id-ID", {
                style: "currency",
                currency: "IDR"
                }).format(number);
            }

            if (data != []){
                let payCurrent = 0;
                let payPercent = 0;
                let payProg = 0;
                let payPesan = `Pembayaran GTC anda belum lunas..<br>💪💪✊️`;
                let payInstallments = 0;

                // Load masing-masing data pembayaran dan akumulasikan
                $.each(data, function( i, v ) {
                    payCurrent += parseInt(v.jumlah_setor);
                    payInstallments ++;
                }); 

                // Kalkulasi progress
                payProg = (payCurrent / 3750000);
                // Dibuat persentase
                payPercent = String(Math.floor(payProg*100));
                // Jika sudah lunas
                switch (payProg) {
                    case 1:
                        payPercent = 'Lunas ' + payPercent;
                        payPesan = `Anda sudah melunasi pembayaran GTC.<br>🤝👍🏻👏`;
                        sudahBayar(payCurrent, payPercent, payPesan, payInstallments);
                        break;
                    case 0:
                        belumBayar();
                        break;
                    default:
                        sudahBayar(payCurrent, payPercent, payPesan, payInstallments);
                        break;
                }
                
            }else{
                belumBayar();
            }

            function belumBayar() {
                $(".payment-current").text('Data pemasukan tidak ditemukan.');
                $(".payment-progress-percent").text('Belum Bayar');
                $(".payment-progress").css('--progress-fill','5%');
                $(".payment-pesan").html(`
                    Berdasarkan data dari Travel, Anda belum melakukan pembayaran GTC..<br>💪💪💪
                `);
            }

            function sudahBayar(p1, p2, p3, p4) {
                $(".payment-current").text(`${rupiah(p1)} (${p4}x)`);
                $(".payment-progress-percent").text(`${p2}%`);
                $(".payment-progress").css('--progress-fill',`${p2}%`);
                $(".payment-pesan").html(p3);
            }

            // Done loading Thumbnail
            clearInterval(procOncePembayaranSingle);
        }, 1000);
    }
    modulePembayaranSingle();
</script>